<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - HealthyBowl</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .form-input {
            transition: all 0.3s ease;
        }
        .form-input:focus {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.15);
        }
        .required::after {
            content: " *";
            color: #ef4444;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <!-- Logo -->
                <div class="flex items-center">
                    <img src="logo.png"
                         alt="HealthyBowl Logo"
                         class="h-36 w-auto object-contain -mb-3">
                </div>

                <!-- Navigation Menu -->
                <nav class="hidden md:flex space-x-8">
                    <a href="homepage" class="text-gray-600 hover:text-green-600 transition-colors text-lg font-semibold">Home</a>
                    <a href="homepage#plans" class="text-gray-600 hover:text-green-600 transition-colors text-lg font-semibold">Our Subscriptions</a>
                    <a href="/about" class="text-gray-600 hover:text-green-600 transition-colors text-lg font-semibold">About Us</a>
                    <a href="/contact" class="text-gray-600 hover:text-green-600 transition-colors text-lg font-semibold">Contact Us</a>
                </nav>

                <!-- Cart Display -->
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <a href="/cart" class="flex items-center space-x-3 text-gray-600 hover:text-green-600 transition-colors">
                            <div class="relative">
                                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 00-16.536-1.84M7.5 14.25L5.106 5.272M6 20.25a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm12.75 0a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"></path>
                                </svg>
                                <span id="cartCount" class="absolute -top-2 -right-2 bg-green-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold">0</span>
                            </div>
                            <span class="hidden sm:block font-semibold text-lg">â‚¹<span id="cartTotal">0</span></span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="py-16 bg-gradient-to-br from-gray-50 via-white to-green-50 relative overflow-hidden">
        <!-- Background Decorative Elements -->
        <div class="absolute inset-0 z-0">
            <div class="absolute top-10 left-10 w-16 h-16 bg-green-200 rounded-full opacity-20 animate-pulse"></div>
            <div class="absolute bottom-20 right-16 w-20 h-20 bg-orange-200 rounded-full opacity-20 animate-bounce" style="animation-delay: 1s;"></div>
            <div class="absolute top-1/2 left-1/4 w-12 h-12 bg-green-300 rounded-full opacity-15 animate-pulse" style="animation-delay: 0.5s;"></div>
            <div class="absolute top-1/3 right-1/4 w-14 h-14 bg-orange-300 rounded-full opacity-15 animate-bounce" style="animation-delay: 1.5s;"></div>
        </div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <!-- Page Header -->
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-5xl font-bold text-green-600 mb-4">Checkout</h1>
                <p class="text-xl text-gray-600">Complete your order and get fresh, healthy meals delivered</p>
            </div>

            <!-- Check Delivery Availability -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8 border border-green-100">
                <div class="flex items-center mb-4">
                    <svg class="w-6 h-6 text-red-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    <h2 class="text-2xl font-bold text-gray-900">Check Delivery Availability</h2>
                </div>
                <div class="flex gap-4">
                    <input type="text" id="pincodeCheck" placeholder="Enter your pincode" 
                           class="flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 form-input">
                    <button onclick="checkDelivery()" class="bg-blue-600 text-white px-8 py-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors">
                        Check
                    </button>
                </div>
                <div id="deliveryStatus" class="mt-3 text-sm hidden"></div>
            </div>

            <div class="grid lg:grid-cols-2 gap-12">
                <!-- Billing Details -->
                <div class="bg-white rounded-2xl shadow-lg p-8 border border-green-100">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Billing Details</h2>
                    
                    <form id="checkoutForm" class="space-y-6">
                        <!-- Name Fields -->
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2 required">First Name</label>
                                <input type="text" id="firstName" name="firstName" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 form-input"
                                       placeholder="First Name">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2 required">Last Name</label>
                                <input type="text" id="lastName" name="lastName" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 form-input"
                                       placeholder="Last Name">
                            </div>
                        </div>

                        <!-- Contact Information -->
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2 required">Email Address</label>
                                <input type="email" id="email" name="email" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 form-input"
                                       placeholder="Email Address">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2 required">Phone</label>
                                <input type="tel" id="phone" name="phone" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 form-input"
                                       placeholder="Phone">
                            </div>
                        </div>

                        <!-- Address -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2 required">Address</label>
                            <input type="text" id="address1" name="address1" required
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 form-input mb-3"
                                   placeholder="House number and street name">
                            <input type="text" id="address2" name="address2"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 form-input"
                                   placeholder="Apartment, suite, unit, etc. (optional)">
                        </div>

                        <!-- Pincode -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2 required">Pincode</label>
                            <input type="text" id="pincode" name="pincode" required
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 form-input"
                                   placeholder="Pincode">
                        </div>

                        <!-- Delivery Instructions -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Delivery Instructions (Optional)</label>
                            <textarea id="instructions" name="instructions" rows="3"
                                      class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 form-input"
                                      placeholder="Any special delivery instructions..."></textarea>
                        </div>
                    </form>
                </div>

                <!-- Order Summary -->
                <div class="bg-white rounded-2xl shadow-lg p-8 border border-green-100">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Your Order</h2>
                    
                    <!-- Order Items -->
                    <div id="orderItems" class="space-y-4 mb-6">
                        <!-- Order items will be dynamically loaded here -->
                    </div>

                    <!-- Order Summary -->
                    <div class="border-t border-gray-200 pt-6 space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">Subtotal</span>
                            <span class="font-semibold text-gray-900">â‚¹<span id="orderSubtotal">0</span></span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">GST (5%)</span>
                            <span class="font-semibold text-gray-900">â‚¹<span id="orderGst">0</span></span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">Delivery</span>
                            <span class="font-semibold text-green-600">FREE</span>
                        </div>
                        <div class="border-t border-gray-200 pt-3">
                            <div class="flex justify-between items-center">
                                <span class="text-xl font-bold text-gray-900">Total</span>
                                <span class="text-2xl font-bold text-green-600">â‚¹<span id="orderTotal">0</span></span>
                            </div>
                        </div>
                    </div>

                    <!-- Coupon Section -->
                    <div class="mt-6 p-4 bg-gray-50 rounded-xl">
                        <p class="text-sm text-gray-600 mb-2">Have a coupon?</p>
                        <button onclick="toggleCoupon()" class="text-green-600 hover:text-green-800 font-semibold text-sm">
                            Click here to enter your coupon code
                        </button>
                        <div id="couponSection" class="hidden mt-3">
                            <div class="flex gap-2">
                                <input type="text" id="couponCode" placeholder="Enter coupon code"
                                       class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                <button onclick="applyCoupon()" class="bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-green-700 transition-colors">
                                    Apply
                                </button>
                            </div>
                            <div id="couponMessage" class="mt-2 text-sm hidden"></div>
                        </div>
                    </div>

                    <!-- Payment Method -->
                    <div class="mt-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">Payment Method</h3>
                        <div class="flex items-center justify-between p-4 border border-gray-200 rounded-xl">
                            <span class="text-gray-700">Credit Card/Debit Card/NetBanking</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-8 h-5 bg-blue-600 rounded text-white text-xs flex items-center justify-center font-bold">R</div>
                                <div class="w-8 h-5 bg-green-600 rounded text-white text-xs flex items-center justify-center font-bold">âœ“</div>
                                <div class="w-8 h-5 bg-orange-600 rounded text-white text-xs flex items-center justify-center font-bold">P</div>
                                <span class="text-sm text-gray-600 ml-2">Pay by Razorpay</span>
                            </div>
                        </div>
                    </div>

                    <!-- Place Order Button -->
                    <button onclick="placeOrder()" id="placeOrderBtn" disabled
                            class="w-full mt-8 bg-green-600 text-white py-4 px-6 rounded-xl font-bold text-lg hover:bg-green-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl disabled:bg-gray-400 disabled:cursor-not-allowed disabled:transform-none">
                        Place Order
                    </button>

                    <!-- Security Notice -->
                    <div class="mt-4 text-center">
                        <p class="text-xs text-gray-500">ðŸ”’ Your payment information is secure and encrypted</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white relative overflow-hidden">
        <div class="absolute inset-0 z-0">
            <div class="absolute top-10 left-10 w-16 h-16 bg-green-600 rounded-full opacity-10 animate-pulse"></div>
            <div class="absolute bottom-20 right-16 w-20 h-20 bg-orange-500 rounded-full opacity-10 animate-bounce" style="animation-delay: 1s;"></div>
        </div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="py-8 text-center">
                <p class="text-gray-400">&copy; 2024 HealthyBowl. All rights reserved.</p>
                <p class="text-gray-500 text-sm mt-1">HealthyBowl Foods Private Limited</p>
            </div>
        </div>
    </footer>

    <script>
        // Cart functionality
        let cart = JSON.parse(localStorage.getItem('healthybowl_cart')) || [];
        let appliedCoupon = null;

        // Initialize checkout
        function initCheckout() {
            if (cart.length === 0) {
                alert('Your cart is empty! Redirecting to cart page...');
                window.location.href = '/cart';
                return;
            }
            
            loadOrderItems();
            updateOrderSummary();
            updateCartDisplay();
            validateForm();
        }

        // Load order items
        function loadOrderItems() {
            const orderItems = document.getElementById('orderItems');
            orderItems.innerHTML = '';

            cart.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'flex justify-between items-center py-3 border-b border-gray-100';
                itemDiv.innerHTML = `
                    <div class="flex-1">
                        <h4 class="font-semibold text-gray-900">${item.name}</h4>
                        <p class="text-sm text-gray-600">Fresh fruits and sprouts</p>
                    </div>
                    <div class="text-right">
                        <span class="font-semibold text-gray-900">â‚¹${(item.price * item.quantity).toLocaleString()}</span>
                        <p class="text-sm text-gray-600">x ${item.quantity}</p>
                    </div>
                `;
                orderItems.appendChild(itemDiv);
            });
        }

        // Update order summary
        function updateOrderSummary() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const gst = subtotal * 0.05;
            const total = subtotal + gst;

            document.getElementById('orderSubtotal').textContent = subtotal.toLocaleString();
            document.getElementById('orderGst').textContent = gst.toLocaleString();
            document.getElementById('orderTotal').textContent = total.toLocaleString();
        }

        // Update cart display
        function updateCartDisplay() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

            document.getElementById('cartCount').textContent = totalItems;
            document.getElementById('cartTotal').textContent = totalPrice.toLocaleString();
        }

        // Check delivery availability
        function checkDelivery() {
            const pincode = document.getElementById('pincodeCheck').value.trim();
            const deliveryStatus = document.getElementById('deliveryStatus');
            
            if (!pincode) {
                deliveryStatus.textContent = 'Please enter a pincode';
                deliveryStatus.className = 'mt-3 text-sm text-red-600';
                deliveryStatus.classList.remove('hidden');
                return;
            }

            // Simulate delivery check
            const mumbaiThanePincodes = ['400001', '400002', '400003', '400004', '400005', '400006', '400007', '400008', '400009', '400010', '400011', '400012', '400013', '400014', '400015', '400016', '400017', '400018', '400019', '400020', '400021', '400022', '400023', '400024', '400025', '400026', '400027', '400028', '400029', '400030', '400031', '400032', '400033', '400034', '400035', '400036', '400037', '400038', '400039', '400040', '400041', '400042', '400043', '400044', '400045', '400046', '400047', '400048', '400049', '400050', '400051', '400052', '400053', '400054', '400055', '400056', '400057', '400058', '400059', '400060', '400061', '400062', '400063', '400064', '400065', '400066', '400067', '400068', '400069', '400070', '400071', '400072', '400073', '400074', '400075', '400076', '400077', '400078', '400079', '400080', '400081', '400082', '400083', '400084', '400085', '400086', '400087', '400088', '400089', '400090', '400091', '400092', '400093', '400094', '400095', '400096', '400097', '400098', '400099', '400100', '421201', '421202', '421203', '421204', '421205', '421206', '421207', '421208', '421209', '421210'];
            
            if (mumbaiThanePincodes.includes(pincode)) {
                deliveryStatus.textContent = 'âœ… Delivery available in your area!';
                deliveryStatus.className = 'mt-3 text-sm text-green-600';
                deliveryStatus.classList.remove('hidden');
            } else {
                deliveryStatus.textContent = 'âŒ Delivery not available in your area. Please contact support.';
                deliveryStatus.className = 'mt-3 text-sm text-red-600';
                deliveryStatus.classList.remove('hidden');
            }
        }

        // Toggle coupon section
        function toggleCoupon() {
            const couponSection = document.getElementById('couponSection');
            couponSection.classList.toggle('hidden');
        }

        // Apply coupon
        function applyCoupon() {
            const couponCode = document.getElementById('couponCode').value.trim().toUpperCase();
            const couponMessage = document.getElementById('couponMessage');
            
            const validCoupons = {
                'WELCOME10': { discount: 0.1, description: '10% off on first order' },
                'HEALTHY20': { discount: 0.2, description: '20% off on orders above â‚¹2000' },
                'FREESHIP': { discount: 0, description: 'Free delivery' }
            };

            if (validCoupons[couponCode]) {
                appliedCoupon = validCoupons[couponCode];
                couponMessage.textContent = `Coupon applied: ${appliedCoupon.description}`;
                couponMessage.className = 'mt-2 text-sm text-green-600';
                couponMessage.classList.remove('hidden');
                updateOrderSummary();
            } else {
                couponMessage.textContent = 'Invalid coupon code';
                couponMessage.className = 'mt-2 text-sm text-red-600';
                couponMessage.classList.remove('hidden');
            }
        }

        // Validate form
        function validateForm() {
            const form = document.getElementById('checkoutForm');
            const placeOrderBtn = document.getElementById('placeOrderBtn');
            
            function checkForm() {
                const requiredFields = form.querySelectorAll('[required]');
                let allValid = true;
                
                requiredFields.forEach(field => {
                    if (!field.value.trim()) {
                        allValid = false;
                    }
                });
                
                placeOrderBtn.disabled = !allValid;
            }
            
            form.addEventListener('input', checkForm);
            form.addEventListener('change', checkForm);
        }

        // Place order
        function placeOrder() {
            const form = document.getElementById('checkoutForm');
            const formData = new FormData(form);
            
            // Validate form
            const requiredFields = form.querySelectorAll('[required]');
            for (let field of requiredFields) {
                if (!field.value.trim()) {
                    alert('Please fill in all required fields');
                    field.focus();
                    return;
                }
            }
            
            // Collect order data
            const orderData = {
                customer: {
                    firstName: formData.get('firstName'),
                    lastName: formData.get('lastName'),
                    email: formData.get('email'),
                    phone: formData.get('phone'),
                    address: {
                        line1: formData.get('address1'),
                        line2: formData.get('address2'),
                        pincode: formData.get('pincode')
                    },
                    instructions: formData.get('instructions')
                },
                items: cart,
                subtotal: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                gst: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0) * 0.05,
                total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0) * 1.05,
                coupon: appliedCoupon
            };
            
            // In a real application, this would integrate with Razorpay
            console.log('Order Data:', orderData);
            
            // Show success message
            alert('Order placed successfully! (This is a demo - no actual payment was processed)');
            
            // Clear cart and redirect
            localStorage.removeItem('healthybowl_cart');
            window.location.href = 'homepage';
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initCheckout);
    </script>
</body>
</html>
